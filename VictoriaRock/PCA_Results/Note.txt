This enhanced code adds three new visualizations:

Spatial-PCA Distance Correlation:

For each rock type, creates a scatter plot comparing actual spatial distances between samples (x-axis) with their distances in PCA space (y-axis)

Includes R² value to quantify the correlation

Helps answer whether samples that are close spatially also cluster together in PCA space

Spatial Distribution Colored by PC1:

Shows the actual geographic distribution of samples colored by their PC1 values

Reveals if certain PC1 values (representing certain geophysical signatures) cluster in specific geographic areas

Spatial Distribution Colored by PC2:

Same as above but for PC2 values

Helps identify if different components of the geophysical signature have different spatial patterns

Key insights you can derive:

If points cluster along the diagonal in the distance correlation plots, it means spatial proximity corresponds to similarity in geophysical properties
Strong correlations suggest the geophysical patterns are spatially continuous
Weak correlations may indicate more complex relationships or multiple geologic controls
The spatial PC value maps show where different geophysical signatures are concentrated geographically

The output will help you understand:
Whether rocks that are geophysically similar (close in PCA space) are also geographically close
How the principal components relate to actual spatial distribution patterns
Whether different lithologies show different spatial-PCA relationships

Example interpretation:

If mafic volcanics show high correlation (R² > 0.7), it suggests their geophysical signature is consistent across their spatial extent
If pelitic sediments show low correlation (R² < 0.3), it suggests their geophysical properties vary independently of location
Spatial PC maps might reveal that high PC1 values cluster along fault zones, suggesting a structural control